---
title: 'NSS tools : certutil'
slug: 'Mozilla/Projects/NSS/Reference/NSS_tools_:_certutil'
---
<p>Name<br>
 <br>
    certutil — Manage keys and certificate in both NSS databases and other NSS tokens<br>
 <br>
 Synopsis<br>
 <br>
    certutil [options] [[arguments]]<br>
 <br>
 Description<br>
 <br>
    The Certificate Database Tool, certutil, is a command-line utility<br>
    that can create and modify certificate and key databases.<br>
    It can specifically list, generate, modify, or delete certificates, create or<br>
    change the password, generate new public and private key pairs,<br>
    display the contents of the key database, or delete key pairs within  the key database.<br>
 <br>
    Certificate issuance, part of the key and certificate management process, requires that<br>
    keys and certificates be created in the key database. This document discusses certificate<br>
    and key database management. For information on the  security module database management,<br>
    see the modutil manpage.<br>
 <br>
 Options and Arguments<br>
 <br>
    Running certutil always requires one and only one command option to<br>
    specify the type of certificate operation. Each option may take arguments,<br>
    anywhere from none to multiple arguments. The command option -H will list<br>
    all the command options available and their relevant arguments.<br>
 <br>
    Command Options<br>
 <br>
    -A<br>
           Add an existing certificate to a certificate database.<br>
           The certificate database should already exist; if one is<br>
           not present, this command option will initialize one by default.<br>
 <br>
    -B<br>
           Run a series of commands from the specified batch file.<br>
           This requires the -i argument.<br>
 <br>
    -C<br>
           Create a new binary certificate file from a binary<br>
           certificate request file. Use the -i argument to specify<br>
           the certificate request file. If this argument is not<br>
           used, certutil prompts for a filename.<br>
 <br>
    -D<br>
           Delete a certificate from the certificate database.</p>

<p>  --rename<br>
          Change the database nickname of a certificate.</p>

<p><br>
    -E<br>
           Add an email certificate to the certificate database.<br>
 <br>
    -F<br>
           Delete a private key from a key database. Specify the<br>
           key to delete with the -n argument. Specify the database<br>
           from which to delete the key with the -d argument. Use<br>
           the -k argument to specify explicitly whether to delete<br>
           a DSA, RSA, or ECC key. If you don't use the -k<br>
           argument, the option looks for an RSA key matching the<br>
           specified nickname.<br>
 <br>
           When you delete keys, be sure to also remove any<br>
           certificates associated with those keys from the<br>
           certificate database, by using -D. Some smart cards (for<br>
           example, the Litronic card) do not let you remove a<br>
           public key you have generated. In such a case, only the<br>
           private key is deleted from the key pair. You can<br>
           display the public key with the command certutil -K -h<br>
           tokenname.<br>
 <br>
    -G<br>
           Generate a new public and private key pair within a key<br>
           database. The key database should already exist; if one<br>
           is not present, this option will initialize one by<br>
           default. Some smart cards (for example, the Litronic<br>
           card) can store only one key pair. If you create a new<br>
           key pair for such a card, the previous pair is<br>
           overwritten.<br>
 <br>
    -H<br>
           Display a list of the options and arguments used by the<br>
           Certificate Database Tool.<br>
 <br>
    -K<br>
           List the key ID of keys in the key database. A key ID is<br>
           the modulus of the RSA key or the publicValue of the DSA<br>
           key. IDs are displayed in hexadecimal ("0x" is not<br>
           shown).<br>
 <br>
    -L<br>
           List all the certificates, or display information about<br>
           a named certificate, in a certificate database. Use the<br>
           -h tokenname argument to specify the certificate<br>
           database on a particular hardware or software token.<br>
 <br>
    -M<br>
           Modify a certificate's trust attributes using the values<br>
           of the -t argument.<br>
 <br>
    -N<br>
           Create new certificate and key databases.<br>
 <br>
    -O<br>
           Print the certificate chain.<br>
 <br>
    -R<br>
           Create a certificate request file that can be submitted<br>
           to a Certificate Authority (CA) for processing into a<br>
           finished certificate. Output defaults to standard out<br>
           unless you use -o output-file argument. Use the -a<br>
           argument to specify ASCII output.<br>
 <br>
    -S<br>
           Create an individual certificate and add it to a<br>
           certificate database.<br>
 <br>
    -T<br>
           Reset the key database or token.<br>
 <br>
    -U<br>
           List all available modules or print a single named<br>
           module.<br>
 <br>
    -V<br>
           Check the validity of a certificate and its attributes.<br>
 <br>
    -W<br>
           Change the password to a key database.<br>
 <br>
    --merge<br>
           Merge two databases into one.<br>
 <br>
    --upgrade-merge<br>
           Upgrade an old database and merge it into a new<br>
           database. This is used to migrate legacy NSS databases<br>
           (cert8.db and key3.db) into the newer SQLite databases<br>
           (cert9.db and key4.db).<br>
 <br>
    Arguments<br>
 <br>
    Arguments modify a command option and are usually lower case, numbers, or symbols.<br>
 <br>
    -a<br>
           Use ASCII format or allow the use of ASCII format for<br>
           input or output. This formatting follows RFC 1113. For<br>
           certificate requests, ASCII output defaults to standard<br>
           output unless redirected.<br>
 <br>
    -b validity-time<br>
           Specify a time at which a certificate is required to be<br>
           valid. Use when checking certificate validity with the<br>
           -V option. The format of the validity-time argument is<br>
           YYMMDDHHMMSS[+HHMM|-HHMM|Z], which allows offsets to be<br>
           set relative to the validity end time. Specifying<br>
           seconds (SS) is optional. When specifying an explicit<br>
           time, use a Z at the end of the term, YYMMDDHHMMSSZ, to<br>
           close it. When specifying an offset time, use<br>
           YYMMDDHHMMSS+HHMM or YYMMDDHHMMSS-HHMM for adding or<br>
           subtracting time, respectively.<br>
 <br>
           If this option is not used, the validity check defaults<br>
           to the current system time.<br>
 <br>
    -c issuer<br>
           Identify the certificate of the CA from which a new<br>
           certificate will derive its authenticity. Use the exact<br>
           nickname or alias of the CA certificate, or use the CA's<br>
           email address. Bracket the issuer string with quotation<br>
           marks if it contains spaces.<br>
 <br>
    -d [prefix]directory<br>
           Specify the database directory containing the<br>
           certificate and key database files.<br>
 <br>
           certutil supports two types of databases: the legacy<br>
           security databases (cert8.db, key3.db, and secmod.db)<br>
           and new SQLite databases (cert9.db, key4.db, and<br>
           pkcs11.txt).</p>

<p>           NSS recognizes the following prefixes:</p>

<p>           ·   sql: requests the newer database</p>

<p>           ·   dbm: requests the legacy database</p>

<p>           If no prefix is specified the default type is retrieved from NSS_DEFAULT_DB_TYPE. If NSS_DEFAULT_DB_TYPE is not set<br>
            then dbm: is the default.</p>

<p>    --dump-ext-val OID<br>
            For single cert, print binary DER encoding of extension OID.<br>
 <br>
    -e<br>
           Check a certificate's signature during the process of<br>
           validating a certificate.</p>

<p>       --email email-address<br>
            Specify the email address of a certificate to list. Used with the -L command option.</p>

<p>       --extGeneric OID:critical-flag:filename[,OID:critical-flag:filename]...<br>
            Add one or multiple extensions that certutil cannot encode yet, by loading their encodings from external files.</p>

<p>           ·   OID (example): 1.2.3.4</p>

<p>           ·   critical-flag: critical or not-critical</p>

<p>           ·   filename: full path to a file containing an encoded extension</p>

<p><br>
    -f password-file<br>
           Specify a file that will automatically supply the<br>
           password to include in a certificate or to access a<br>
           certificate database. This is a plain-text file<br>
           containing one password. Be sure to prevent unauthorized<br>
           access to this file.<br>
 <br>
    -g keysize<br>
           Set a key size to use when generating new public and<br>
           private key pairs. The minimum is 512 bits and the<br>
           maximum is 16384 bits. The default is 2048 bits. Any size<br>
           between the minimum and maximum is allowed.<br>
 <br>
    -h tokenname<br>
           Specify the name of a token to use or act on. Unless<br>
           specified otherwise the default token is an internal<br>
           slot.<br>
 <br>
    -i input_file<br>
           Pass an input file to the command. Depending on the<br>
           command option, an input file can be a specific<br>
           certificate, a certificate request file, or a batch file<br>
           of commands.<br>
 <br>
    -k rsa|dsa|ec|all<br>
           Specify the type of a key. The valid options are RSA,<br>
           DSA, ECC, or all. The default value is rsa. Specifying<br>
           the type of key can avoid mistakes caused by duplicate<br>
           nicknames.<br>
 <br>
    -k key-type-or-id<br>
            Specify the type or specific ID of a key.</p>

<p>           The valid key type options are rsa, dsa, ec, or all. The default value is rsa. Specifying the type of key can avoid<br>
            mistakes caused by duplicate nicknames. Giving a key type generates a new key pair; giving the ID of an existing key<br>
            reuses that key pair (which is required to renew certificates).<br>
    -l<br>
           Display detailed information when validating a<br>
           certificate with the -V option.<br>
 <br>
    -m serial-number<br>
           Assign a unique serial number to a certificate being created. This operation should be performed by a CA. If no<br>
            serial number is provided a default serial number is made from the current time. Serial numbers are limited to<br>
            integers.<br>
 <br>
    -n nickname<br>
           Specify the nickname of a certificate or key to list,<br>
           create, add to a database, modify, or validate. Bracket<br>
           the nickname string with quotation marks if it contains<br>
           spaces.<br>
 <br>
    -o output-file<br>
           Specify the output file name for new certificates or<br>
           binary certificate requests. Bracket the output-file<br>
           string with quotation marks if it contains spaces. If<br>
           this argument is not used the output destination<br>
           defaults to standard output.<br>
 <br>
    -P dbPrefix<br>
           Specify the prefix used on the certificate and key<br>
           database file. This argument is provided to support<br>
           legacy servers. Most applications do not use a database prefix.<br>
 <br>
    -p phone<br>
           Specify a contact telephone number to include in new<br>
           certificates or certificate requests. Bracket this<br>
           string with quotation marks if it contains spaces.<br>
 <br>
    -q pqgfile or curve-name<br>
            Read an alternate PQG value from the specified file when generating DSA key pairs.<br>
            If this argument is not used,certutil generates its own PQG value. PQG files are created with a separate DSA utility.</p>

<p>           Elliptic curve name is one of the ones from SUITE B: nistp256, nistp384, nistp521</p>

<p>           If NSS has been compiled with support curves outside of SUITE B: sect163k1, nistk163, sect163r1, sect163r2, nistb163,<br>
            sect193r1, sect193r2, sect233k1, nistk233, sect233r1, nistb233, sect239k1, sect283k1, nistk283, sect283r1, nistb283,<br>
            sect409k1, nistk409, sect409r1, nistb409, sect571k1, nistk571, sect571r1, nistb571, secp160k1, secp160r1, secp160r2,<br>
            secp192k1, secp192r1, nistp192, secp224k1, secp224r1, nistp224, secp256k1, secp256r1, secp384r1, secp521r1,<br>
            prime192v1, prime192v2, prime192v3, prime239v1, prime239v2, prime239v3, c2pnb163v1, c2pnb163v2, c2pnb163v3,<br>
            c2pnb176v1, c2tnb191v1, c2tnb191v2, c2tnb191v3, c2pnb208w1, c2tnb239v1, c2tnb239v2, c2tnb239v3, c2pnb272w1,<br>
            c2pnb304w1, c2tnb359w1, c2pnb368w1, c2tnb431r1, secp112r1, secp112r2, secp128r1, secp128r2, sect113r1, sect113r2<br>
            sect131r1, sect131r2</p>

<p><br>
    -r<br>
           Display a certificate's binary DER encoding when listing<br>
           information about that certificate with the -L option.<br>
 <br>
    -s subject<br>
           Identify a particular certificate owner for new<br>
           certificates or certificate requests. Bracket this<br>
           string with quotation marks if it contains spaces. The<br>
           subject identification format follows RFC #1485.<br>
 <br>
    -t trustargs<br>
           Specify the trust attributes to modify in an existing<br>
           certificate or to apply to a certificate when creating<br>
           it or adding it to a database. There are three available<br>
           trust categories for each certificate, expressed in the<br>
           order SSL, email, object signing for each trust setting.<br>
           In each category position, use none, any, or all of the<br>
           attribute codes:<br>
 <br>
           + p - Valid peer<br>
           + P - Trusted peer (implies p)<br>
           + c - Valid CA<br>
           + T - Trusted CA to issue client certificates (implies<br>
             c)<br>
           + C - Trusted CA to issue server certificates (SSL only)<br>
             (implies c)<br>
           + u - Certificate can be used for authentication or<br>
             signing<br>
           + w - Send warning (use with other attributes to include<br>
             a warning when the certificate is used in that<br>
             context)<br>
 <br>
           The attribute codes for the categories are separated by<br>
           commas, and the entire set of attributes enclosed by<br>
           quotation marks. For example:<br>
 <br>
           -t "TC,C,T"<br>
 <br>
           Use the -L option to see a list of the current<br>
           certificates and trust attributes in a certificate<br>
           database.</p>

<p>           Note that the output of the -L option may include "u" flag, which means that there is a private key associated with<br>
            the certificate. It is a dynamic flag and you cannot set it with certutil.<br>
 <br>
    -u certusage<br>
           Specify a usage context to apply when validating a<br>
           certificate with the -V option.<br>
 <br>
           The contexts are the following:</p>

<p>           ·   C (as an SSL client)</p>

<p>           ·   V (as an SSL server)</p>

<p>           ·   L (as an SSL CA)</p>

<p>           ·   A (as Any CA)</p>

<p>           ·   Y (Verify CA)</p>

<p>           ·   S (as an email signer)</p>

<p>           ·   R (as an email recipient)</p>

<p>           ·   O (as an OCSP status responder)</p>

<p>           ·   J (as an object signer)</p>

<p><br>
    -v valid-months<br>
           Set the number of months a new certificate will be<br>
           valid. The validity period begins at the current system<br>
           time unless an offset is added or subtracted with the -w<br>
           option. If this argument is not used, the default<br>
           validity period is three months. When this argument is<br>
           used, the default three-month period is automatically<br>
           added to any value given in the valid-month argument.<br>
           For example, using this option to set a value of 3 would<br>
           cause 3 to be added to the three-month default, creating<br>
           a validity period of six months. You can use negative<br>
           values to reduce the default period. For example,<br>
           setting a value of -2 would subtract 2 from the default<br>
           and create a validity period of one month.<br>
 <br>
    -w offset-months<br>
           Set an offset from the current system time, in months,<br>
           for the beginning of a certificate's validity period.<br>
           Use when creating the certificate or adding it to a<br>
           database. Express the offset in integers, using a minus<br>
           sign (-) to indicate a negative offset. If this argument<br>
           is not used, the validity period begins at the current<br>
           system time. The length of the validity period is set<br>
           with the -v argument.<br>
 <br>
    -X<br>
           Force the key and certificate database to open in<br>
           read-write mode. This is used with the -U and -L command<br>
           options.<br>
 <br>
    -x<br>
           Use certutil to generate the signature for a certificate<br>
           being created or added to a database, rather than<br>
           obtaining a signature from a separate CA.<br>
 <br>
    -y exp<br>
           Set an alternate exponent value to use in generating a<br>
           new RSA public key for the database, instead of the<br>
           default value of 65537. The available alternate values<br>
           are 3 and 17.<br>
 <br>
    -z noise-file<br>
           Read a seed value from the specified file to generate a<br>
           new private and public key pair. This argument makes it<br>
           possible to use hardware-generated seed values or<br>
           manually create a value from the keyboard. The minimum<br>
           file size is 20 bytes.<br>
 <br>
    -0 SSO_password<br>
           Set a site security officer password on a token.<br>
 <br>
    -1 | --keyUsage keyword,keyword<br>
           Set a Netscape Certificate Type Extension in the<br>
           certificate. There are several available keywords:<br>
 <br>
           + digital signature<br>
           + nonRepudiation<br>
           + keyEncipherment<br>
           + dataEncipherment<br>
           + keyAgreement<br>
           + certSigning<br>
           + crlSigning<br>
           + critical<br>
 <br>
    -2<br>
           Add a basic constraint extension to a certificate that<br>
           is being created or added to a database. This extension<br>
           supports the certificate chain verification process.<br>
           certutil prompts for the certificate constraint<br>
           extension to select.<br>
 <br>
           X.509 certificate extensions are described in RFC 5280.<br>
 <br>
    -3<br>
           Add an authority key ID extension to a certificate that<br>
           is being created or added to a database. This extension<br>
           supports the identification of a particular certificate,<br>
           from among multiple certificates associated with one<br>
           subject name, as the correct issuer of a certificate.<br>
           The Certificate Database Tool will prompt you to select<br>
           the authority key ID extension.<br>
 <br>
           X.509 certificate extensions are described in RFC 5280.<br>
 <br>
    -4<br>
           Add a CRL distribution point extension to a certificate<br>
           that is being created or added to a database. This<br>
           extension identifies the URL of a certificate's<br>
           associated certificate revocation list (CRL). certutil<br>
           prompts for the URL.<br>
 <br>
           X.509 certificate extensions are described in RFC 5280.<br>
 <br>
    -5 | --nsCertType keyword,keyword<br>
           Add a Netscape certificate type extension to a<br>
           certificate that is being created or added to the<br>
           database. There are several available keywords:<br>
 <br>
           + sslClient<br>
           + sslServer<br>
           + smime<br>
           + objectSigning<br>
           + sslCA<br>
           + smimeCA<br>
           + objectSigningCA<br>
           + critical<br>
 <br>
           X.509 certificate extensions are described in RFC 5280.<br>
 <br>
    -6 | --extKeyUsage keyword,keyword<br>
           Add an extended key usage extension to a certificate<br>
           that is being created or added to the database. Several<br>
           keywords are available:<br>
 <br>
           + serverAuth<br>
           + clientAuth<br>
           + codeSigning<br>
           + emailProtection<br>
           + timeStamp<br>
           + ocspResponder<br>
           + stepUp<br>
           + critical<br>
 <br>
           X.509 certificate extensions are described in RFC 5280.<br>
 <br>
    -7 emailAddrs<br>
           Add a comma-separated list of email addresses to the<br>
           subject alternative name extension of a certificate or<br>
           certificate request that is being created or added to<br>
           the database. Subject alternative name extensions are<br>
           described in Section 4.2.1.7 of RFC 3280.<br>
 <br>
    -8 dns-names<br>
           Add a comma-separated list of DNS names to the subject<br>
           alternative name extension of a certificate or<br>
           certificate request that is being created or added to<br>
           the database. Subject alternative name extensions are<br>
           described in Section 4.2.1.7 of RFC 3280.<br>
 <br>
    --extAIA<br>
           Add the Authority Information Access extension to the<br>
           certificate. X.509 certificate extensions are described<br>
           in RFC 5280.<br>
 <br>
    --extSIA<br>
           Add the Subject Information Access extension to the<br>
           certificate. X.509 certificate extensions are described<br>
           in RFC 5280.<br>
 <br>
    --extCP<br>
           Add the Certificate Policies extension to the<br>
           certificate. X.509 certificate extensions are described<br>
           in RFC 5280.<br>
 <br>
    --extPM<br>
           Add the Policy Mappings extension to the certificate.<br>
           X.509 certificate extensions are described in RFC 5280.<br>
 <br>
    --extPC<br>
           Add the Policy Constraints extension to the certificate.<br>
           X.509 certificate extensions are described in RFC 5280.<br>
 <br>
    --extIA<br>
           Add the Inhibit Any Policy Access extension to the<br>
           certificate. X.509 certificate extensions are described<br>
           in RFC 5280.<br>
 <br>
    --extSKID<br>
           Add the Subject Key ID extension to the certificate.<br>
           X.509 certificate extensions are described in RFC 5280.<br>
 <br>
    --source-dir certdir<br>
           Identify the certificate database directory to upgrade.<br>
 <br>
    --source-prefix certdir<br>
           Give the prefix of the certificate and key databases to<br>
           upgrade.<br>
 <br>
    --upgrade-id uniqueID<br>
           Give the unique ID of the database to upgrade.<br>
 <br>
    --upgrade-token-name name<br>
           Set the name of the token to use while it is being<br>
           upgraded.<br>
 <br>
    -@ pwfile<br>
           Give the name of a password file to use for the database<br>
           being upgraded.<br>
 <br>
 Usage and Examples<br>
 <br>
    Most of the command options in the examples listed here have<br>
    more arguments available. The arguments included in these<br>
    examples are the most common ones or are used to illustrate a<br>
    specific scenario. Use the -H option to show the complete list<br>
    of arguments for each command option.<br>
 <br>
    Creating New Security Databases<br>
 <br>
    Certificates, keys, and security modules related to managing<br>
    certificates are stored in three related databases:<br>
      * cert8.db or cert9.db<br>
      * key3.db or key4.db<br>
      * secmod.db or pkcs11.txt<br>
 <br>
    These databases must be created before certificates or keys can<br>
    be generated.<br>
 certutil -N -d [sql:]directory<br>
 <br>
    Creating a Certificate Request<br>
 <br>
    A certificate request contains most or all of the information<br>
    that is used to generate the final certificate. This request is<br>
    submitted separately to a certificate authority and is then<br>
    approved by some mechanism (automatically or by human review).<br>
    Once the request is approved, then the certificate is<br>
    generated.<br>
 $ certutil -R -k key-type-or-id [-q pqgfile|curve-name] -g key-size -s s<br>
 ubject [-h tokenname] -d [sql:]directory [-p phone] [-o output-file] [-a<br>
 ]<br>
 <br>
    The -R command options requires four arguments:<br>
      * -k to specify either the key type to generate or, when<br>
        renewing a certificate, the existing key pair to use<br>
      * -g to set the keysize of the key to generate<br>
      * -s to set the subject name of the certificate<br>
      * -d to give the security database directory<br>
 <br>
    The new certificate request can be output in ASCII format (-a)<br>
    or can be written to a specified file (-o).<br>
 <br>
    For example:<br>
 $ certutil -R -k ec -q nistb409 -g 512 -s "CN=John Smith,O=Example Corp,<br>
 L=Mountain View,ST=California,C=US" -d sql:/home/my/sharednssdb -p 650-5<br>
 55-0123 -a -o cert.cer<br>
 <br>
 Generating key.  This may take a few moments...<br>
 <br>
 <br>
 Certificate request generated by Netscape<br>
 Phone: 650-555-0123<br>
 Common Name: John Smith<br>
 Email: (not ed)<br>
 Organization: Example Corp<br>
 State: California<br>
 Country: US<br>
 <br>
 -----BEGIN NEW CERTIFICATE REQUEST-----<br>
 MIIBIDCBywIBADBmMQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEW<br>
 MBQGA1UEBxMNTW91bnRhaW4gVmlldzEVMBMGA1UEChMMRXhhbXBsZSBDb3JwMRMw<br>
 EQYDVQQDEwpKb2huIFNtaXRoMFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAMVUpDOZ<br>
 KmHnOx7reP8Cc0Lk+fFWEuYIDX9W5K/BioQOKvEjXyQZhit9aThzBVMoSf1Y1S8J<br>
 CzdUbCg1+IbnXaECAwEAAaAAMA0GCSqGSIb3DQEBBQUAA0EAryqZvpYrUtQ486Ny<br>
 qmtyQNjIi1F8c1Z+TL4uFYlMg8z6LG/J/u1E5t1QqB5e9Q4+BhRbrQjRR1JZx3tB<br>
 1hP9Gg==<br>
 -----END NEW CERTIFICATE REQUEST-----<br>
 <br>
    Creating a Certificate<br>
 <br>
    A valid certificate must be issued by a trusted CA. This can be<br>
    done by specifying a CA certificate (-c) that is stored in the<br>
    certificate database. If a CA key pair is not available, you<br>
    can create a self-signed certificate using the -x argument with<br>
    the -S command option.<br>
 $ certutil -S -k rsa|dsa|ec -n certname -s subject [-c issuer |-x] -t tr<br>
 ustargs -d [sql:]directory [-m serial-number] [-v valid-months] [-w offs<br>
 et-months] [-p phone] [-1] [-2] [-3] [-4] [-5 keyword] [-6 keyword] [-7<br>
 emailAddress] [-8 dns-names] [--extAIA] [--extSIA] [--extCP] [--extPM] [<br>
 --extPC] [--extIA] [--extSKID]<br>
 <br>
    The series of numbers and --ext* options set certificate<br>
    extensions that can be added to the certificate when it is<br>
    generated by the CA.<br>
 <br>
    For example, this creates a self-signed certificate:<br>
 $ certutil -S -s "CN=Example CA" -n my-ca-cert -x -t "C,C,C" -1 -2 -5 -m<br>
  3650<br>
 <br>
    From there, new certificates can reference the self-signed<br>
    certificate:<br>
 $ certutil -S -s "CN=My Server Cert" -n my-server-cert -c "my-ca-cert" -<br>
 t "u,u,u" -1 -5 -6 -8 -m 730<br>
 <br>
    Generating a Certificate from a Certificate Request<br>
 <br>
    When a certificate request is created, a certificate can be<br>
    generated by using the request and then referencing a<br>
    certificate authority signing certificate (the issuer specified<br>
    in the -c argument). The issuing certificate must be in the<br>
    certificate database in the specified directory.<br>
 certutil -C -c issuer -i cert-request-file -o output-file [-m serial-num<br>
 ber] [-v valid-months] [-w offset-months] -d [sql:]directory [-1] [-2] [<br>
 -3] [-4] [-5 keyword] [-6 keyword] [-7 emailAddress] [-8 dns-names]<br>
 <br>
    For example:<br>
 $ certutil -C -c "my-ca-cert" -i /home/certs/cert.req -o cert.cer -m 010<br>
  -v 12 -w 1 -d sql:/home/my/sharednssdb -1 nonRepudiation,dataEncipherme<br>
 nt -5 sslClient -6 clientAuth -7 <a class="link-mailto" href="mailto:jsmith@example.com">jsmith@example.com</a><br>
 <br>
    Generating Key Pairs<br>
 <br>
    Key pairs are generated automatically with a certificate<br>
    request or certificate, but they can also be generated<br>
    independently using the -G command option.<br>
 certutil -G -d [sql:]directory | -h tokenname -k key-type -g key-size [-<br>
 y exponent-value] -q pqgfile|curve-name<br>
 <br>
    For example:<br>
 $ certutil -G -h lunasa -k ec -g 256 -q sect193r2<br>
 <br>
    Listing Certificates<br>
 <br>
    The -L command option lists all of the certificates listed in<br>
    the certificate database. The path to the directory (-d) is<br>
    required.<br>
 $ certutil -L -d sql:/home/my/sharednssdb<br>
 <br>
 Certificate Nickname                                         Trust Attri<br>
 butes<br>
                                                              SSL,S/MIME,<br>
 JAR/XPI<br>
 <br>
 CA Administrator of Instance pki-ca1's Example Domain ID     u,u,u<br>
 TPS Administrator's Example Domain ID                        u,u,u<br>
 Google Internet Authority                                    ,,<br>
 Certificate Authority - Example Domain                       CT,C,C<br>
 <br>
    Using additional arguments with -L can return and print the<br>
    information for a single, specific certificate. For example,<br>
    the -n argument passes the certificate name, while the -a<br>
    argument prints the certificate in ASCII format:<br>
 $ certutil -L -d sql:/home/my/sharednssdb -a -n "Certificate Authority -<br>
  Example Domain"<br>
 <br>
 -----BEGIN CERTIFICATE-----<br>
 MIIDmTCCAoGgAwIBAgIBATANBgkqhkiG9w0BAQUFADA5MRcwFQYDVQQKEw5FeGFt<br>
 cGxlIERvbWFpbjEeMBwGA1UEAxMVQ2VydGlmaWNhdGUgQXV0aG9yaXR5MB4XDTEw<br>
 MDQyOTIxNTY1OFoXDTEyMDQxODIxNTY1OFowOTEXMBUGA1UEChMORXhhbXBsZSBE<br>
 b21haW4xHjAcBgNVBAMTFUNlcnRpZmljYXRlIEF1dGhvcml0eTCCASIwDQYJKoZI<br>
 hvcNAQEBBQADggEPADCCAQoCggEBAO/bqUli2KwqXFKmMMG93KN1SANzNTXA/Vlf<br>
 Tmrih3hQgjvR1ktIY9aG6cB7DSKWmtHp/+p4PUCMqL4ZrSGt901qxkePyZ2dYmM2<br>
 RnelK+SEUIPiUtoZaDhNdiYsE/yuDE8vQWj0vHCVL0w72qFUcSQ/WZT7FCrnUIUI<br>
 udeWnoPSUn70gLhcj/lvxl7K9BHyD4Sq5CzktwYtFWLiiwV+ZY/Fl6JgbGaQyQB2<br>
 bP4iRMfloGqsxGuB1evWVDF1haGpFDSPgMnEPSLg3/3dXn+HDJbZ29EU8/xKzQEb<br>
 3V0AHKbu80zGllLEt2Zx/WDIrgJEN9yMfgKFpcmL+BvIRsmh0VsCAwEAAaOBqzCB<br>
 qDAfBgNVHSMEGDAWgBQATgxHQyRUfKIZtdp55bZlFr+tFzAPBgNVHRMBAf8EBTAD<br>
 AQH/MA4GA1UdDwEB/wQEAwIBxjAdBgNVHQ4EFgQUAE4MR0MkVHyiGbXaeeW2ZRa/<br>
 rRcwRQYIKwYBBQUHAQEEOTA3MDUGCCsGAQUFBzABhilodHRwOi8vbG9jYWxob3N0<br>
 LmxvY2FsZG9tYWluOjkxODAvY2Evb2NzcDANBgkqhkiG9w0BAQUFAAOCAQEAi8Gk<br>
 L3XO43u7/TDOeEsWPmq+jZsDZ3GZ85Ajt3KROLWeKVZZZa2E2Hnsvf2uXbk5amKe<br>
 lRxdSeRH9g85pv4KY7Z8xZ71NrI3+K3uwmnqkc6t0hhYb1mw/gx8OAAoluQx3biX<br>
 JBDxjI73Cf7XUopplHBjjiwyGIJUO8BEZJ5L+TF4P38MJz1snLtzZpEAX5bl0U76<br>
 bfu/tZFWBbE8YAWYtkCtMcalBPj6jn2WD3M01kGozW4mmbvsj1cRB9HnsGsqyHCu<br>
 U0ujlL1H/RWcjn607+CTeKH9jLMUqCIqPJNOa+kq/6F7NhNRRiuzASIbZc30BZ5a<br>
 nI7q5n1USM3eWQlVXw==<br>
 -----END CERTIFICATE-----<br>
 <br>
    Listing Keys<br>
 <br>
    Keys are the original material used to encrypt certificate<br>
    data. The keys generated for certificates are stored<br>
    separately, in the key database.<br>
 <br>
    To list all keys in the database, use the -K command option and<br>
    the (required) -d argument to give the path to the directory.<br>
 $ certutil -K -d sql:/home/my/sharednssdb<br>
 certutil: Checking token "NSS Certificate DB" in slot "NSS User Private<br>
 Key and Certificate Services                  "<br>
 &lt; 0&gt; rsa      455a6673bde9375c2887ec8bf8016b3f9f35861d   Thawte Freemail<br>
  Member's Thawte Consulting (Pty) Ltd. ID<br>
 &lt; 1&gt; rsa      40defeeb522ade11090eacebaaf1196a172127df   Example Domain<br>
 Administrator Cert<br>
 &lt; 2&gt; rsa      1d0b06f44f6c03842f7d4f4a1dc78b3bcd1b85a5   John Smith user<br>
  cert<br>
 <br>
    There are ways to narrow the keys listed in the search results:<br>
      * To return a specific key, use the -n name argument with the<br>
        name of the key.<br>
      * If there are multiple security devices loaded, then the -h<br>
        tokenname argument can search a specific token or all<br>
        tokens.<br>
      * If there are multiple key types available, then the -k<br>
        key-type argument can search a specific type of key, like<br>
        RSA, DSA, or ECC.<br>
 <br>
    Listing Security Modules<br>
 <br>
    The devices that can be used to store certificates -- both<br>
    internal databases and external devices like smart cards -- are<br>
    recognized and used by loading security modules. The -U command<br>
    option lists all of the security modules listed in the<br>
    secmod.db database. The path to the directory (-d) is required.<br>
 $ certutil -U -d sql:/home/my/sharednssdb<br>
 <br>
     slot: NSS User Private Key and Certificate Services<br>
 <br>
    token: NSS Certificate DB<br>
 <br>
     slot: NSS Internal Cryptographic Services<br>
 <br>
    token: NSS Generic Crypto Services<br>
 <br>
    Adding Certificates to the Database<br>
 <br>
    Existing certificates or certificate requests can be added<br>
    manually to the certificate database, even if they were<br>
    generated elsewhere. This uses the -A command option.<br>
 certutil -A -n certname -t trustargs -d [sql:]directory [-a] [-i input-f<br>
 ile]<br>
 <br>
    For example:<br>
 $ certutil -A -n "CN=My SSL Certificate" -t "u,u,u" -d sql:/home/my/shar<br>
 ednssdb -i /home/example-certs/cert.cer<br>
 <br>
    A related command option, -E, is used specifically to add email<br>
    certificates to the certificate database. The -E command has<br>
    the same arguments as the -A command. The trust arguments for<br>
    certificates have the format SSL,S/MIME,Code-signing, so the<br>
    middle trust settings relate most to email certificates (though<br>
    the others can be set). For example:<br>
 $ certutil -E -n "CN=John Smith Email Cert" -t ",Pu," -d sql:/home/my/sh<br>
 arednssdb -i /home/example-certs/email.cer<br>
 <br>
    Deleting Certificates to the Database<br>
 <br>
    Certificates can be deleted from a database using the -D<br>
    option. The only required options are to give the security<br>
    database directory and to identify the certificate nickname.<br>
 certutil -D -d [sql:]directory -n "nickname"<br>
 <br>
    For example:<br>
 $ certutil -D -d sql:/home/my/sharednssdb -n "my-ssl-cert"<br>
 <br>
    Validating Certificates<br>
 <br>
    A certificate contains an expiration date in itself, and<br>
    expired certificates are easily rejected. However, certificates<br>
    can also be revoked before they hit their expiration date.<br>
    Checking whether a certificate has been revoked requires<br>
    validating the certificate. Validation can also be used to<br>
    ensure that the certificate is only used for the purposes it<br>
    was initially issued for. Validation is carried out by the -V<br>
    command option.<br>
 certutil -V -n certificate-name [-b time] [-e] [-u cert-usage] -d [sql:]<br>
 directory<br>
 <br>
    For example, to validate an email certificate:<br>
 $ certutil -V -n "John Smith's Email Cert" -e -u S,R -d sql:/home/my/sha<br>
 rednssdb<br>
 <br>
    Modifying Certificate Trust Settings<br>
 <br>
    The trust settings (which relate to the operations that a<br>
    certificate is allowed to be used for) can be changed after a<br>
    certificate is created or added to the database. This is<br>
    especially useful for CA certificates, but it can be performed<br>
    for any type of certificate.<br>
 certutil -M -n certificate-name -t trust-args -d [sql:]directory<br>
 <br>
    For example:<br>
 $ certutil -M -n "My CA Certificate" -d sql:/home/my/sharednssdb -t "CTu<br>
 ,CTu,CTu"<br>
 <br>
    Printing the Certificate Chain<br>
 <br>
    Certificates can be issued in chains because every certificate<br>
    authority itself has a certificate; when a CA issues a<br>
    certificate, it essentially stamps that certificate with its<br>
    own fingerprint. The -O prints the full chain of a certificate,<br>
    going from the initial CA (the root CA) through ever<br>
    intermediary CA to the actual certificate. For example, for an<br>
    email certificate with two CAs in the chain:<br>
 $ certutil -d sql:/home/my/sharednssdb -O -n "<a class="link-mailto" href="mailto:jsmith@example.com">jsmith@example.com</a>"<br>
 "Builtin Object Token:Thawte Personal Freemail CA" [E=personal-freemail@<br>
 thawte.com,CN=Thawte Personal Freemail CA,OU=Certification Services Divi<br>
 sion,O=Thawte Consulting,L=Cape Town,ST=Western Cape,C=ZA]<br>
 <br>
   "Thawte Personal Freemail Issuing CA - Thawte Consulting" [CN=Thawte P<br>
 ersonal Freemail Issuing CA,O=Thawte Consulting (Pty) Ltd.,C=ZA]<br>
 <br>
     "(null)" [<a class="link-mailto" href="mailto:E=jsmith@example.com,CN=Thawte">E=jsmith@example.com,CN=Thawte</a> Freemail Member]<br>
 <br>
    Resetting a Token<br>
 <br>
    The device which stores certificates -- both external hardware<br>
    devices and internal software databases -- can be blanked and<br>
    reused. This operation is performed on the device which stores<br>
    the data, not directly on the security databases, so the<br>
    location must be referenced through the token name (-h) as well<br>
    as any directory path. If there is no external token used, the<br>
    default value is internal.<br>
 certutil -T -d [sql:]directory -h token-name -0 security-officer-passwor<br>
 d<br>
 <br>
    Many networks have dedicated personnel who handle changes to<br>
    security tokens (the security officer). This person must supply<br>
    the password to access the specified token. For example:<br>
 $ certutil -T -d sql:/home/my/sharednssdb -h nethsm -0 secret<br>
 <br>
    Upgrading or Merging the Security Databases<br>
 <br>
    Many networks or applications may be using older BerkeleyDB<br>
    versions of the certificate database (cert8.db). Databases can<br>
    be upgraded to the new SQLite version of the database<br>
    (cert9.db) using the --upgrade-merge command option or existing<br>
    databases can be merged with the new cert9.db databases using<br>
    the ---merge command.<br>
 <br>
    The --upgrade-merge command must give information about the<br>
    original database and then use the standard arguments (like -d)<br>
    to give the information about the new databases. The command<br>
    also requires information that the tool uses for the process to<br>
    upgrade and write over the original database.<br>
 certutil --upgrade-merge -d [sql:]directory [-P dbprefix] --source-dir d<br>
 irectory --source-prefix dbprefix --upgrade-id id --upgrade-token-name n<br>
 ame [-@ password-file]<br>
 <br>
    For example:<br>
 $ certutil --upgrade-merge -d sql:/home/my/sharednssdb --source-dir /opt<br>
 /my-app/alias/ --source-prefix serverapp- --upgrade-id 1 --upgrade-token<br>
 -name internal<br>
 <br>
    The --merge command only requires information about the<br>
    location of the original database; since it doesn't change the<br>
    format of the database, it can write over information without<br>
    performing interim step.<br>
 certutil --merge -d [sql:]directory [-P dbprefix] --source-dir directory<br>
  --source-prefix dbprefix [-@ password-file]<br>
 <br>
    For example:<br>
 $ certutil --merge -d sql:/home/my/sharednssdb --source-dir /opt/my-app/<br>
 alias/ --source-prefix serverapp-<br>
 <br>
    Running certutil Commands from a Batch File<br>
 <br>
    A series of commands can be run sequentially from a text file<br>
    with the -B command option. The only argument for this<br>
    specifies the input file.<br>
 $ certutil -B -i /path/to/batch-file<br>
 <br>
 NSS Database Types<br>
 <br>
    NSS originally used BerkeleyDB databases to store security<br>
    information. The last versions of these legacy databases are:<br>
      * cert8.db for certificates<br>
      * key3.db for keys<br>
      * secmod.db for PKCS #11 module information<br>
 <br>
    BerkeleyDB has performance limitations, though, which prevent<br>
    it from being easily used by multiple applications<br>
    simultaneously. NSS has some flexibility that allows<br>
    applications to use their own, independent database engine<br>
    while keeping a shared database and working around the access<br>
    issues. Still, NSS requires more flexibility to provide a truly<br>
    shared security database.<br>
 <br>
    In 2009, NSS introduced a new set of databases that are SQLite<br>
    databases rather than BerkleyDB. These new databases provide<br>
    more accessibility and performance:<br>
      * cert9.db for certificates<br>
      * key4.db for keys<br>
      * pkcs11.txt, which is listing of all of the PKCS #11 modules<br>
        contained in a new subdirectory in the security databases<br>
        directory<br>
 <br>
    Because the SQLite databases are designed to be shared, these<br>
    are the shared database type. The shared database type is<br>
    preferred; the legacy format is included for backward<br>
    compatibility.<br>
 <br>
    By default, the tools (certutil, pk12util, modutil) assume that<br>
    the given security databases follow the more common legacy<br>
    type. Using the SQLite databases must be manually specified by<br>
    using the sql: prefix with the given security directory. For<br>
    example:<br>
 $ certutil -L -d sql:/home/my/sharednssdb<br>
 <br>
    To set the shared database type as the default type for the<br>
    tools, set the NSS_DEFAULT_DB_TYPE environment variable to sql:<br>
 export NSS_DEFAULT_DB_TYPE="sql"<br>
 <br>
    This line can be set added to the ~/.bashrc file to make the<br>
    change permanent.<br>
 <br>
    Most applications do not use the shared database by default,<br>
    but they can be configured to use them. For example, this<br>
    how-to article covers how to configure Firefox and Thunderbird<br>
    to use the new shared NSS databases:<br>
      * <a class="link-https" href="https://wiki.mozilla.org/NSS_Shared_DB_Howto">https://wiki.mozilla.org/NSS_Shared_DB_Howto</a><br>
 <br>
    For an engineering draft on the changes in the shared NSS<br>
    databases, see the NSS project wiki:<br>
      * <a class="link-https" href="https://wiki.mozilla.org/NSS_Shared_DB">https://wiki.mozilla.org/NSS_Shared_DB</a><br>
 <br>
 See Also<br>
 <br>
    pk12util (1)<br>
 <br>
    modutil (1)<br>
 <br>
    certutil has arguments or operations that use features defined<br>
    in several IETF RFCs.<br>
      * <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280">http://tools.ietf.org/html/rfc5280</a><br>
      * <a class="external" href="https://datatracker.ietf.org/doc/html/rfc1113">http://tools.ietf.org/html/rfc1113</a><br>
      * <a class="external" href="https://datatracker.ietf.org/doc/html/rfc1485">http://tools.ietf.org/html/rfc1485</a><br>
 <br>
    The NSS wiki has information on the new database design and how<br>
    to configure applications to use it.<br>
      * <a class="link-https" href="https://wiki.mozilla.org/NSS_Shared_DB_Howto">https://wiki.mozilla.org/NSS_Shared_DB_Howto</a><br>
      * <a class="link-https" href="https://wiki.mozilla.org/NSS_Shared_DB">https://wiki.mozilla.org/NSS_Shared_DB</a><br>
 <br>
 Additional Resources<br>
 <br>
    For information about NSS and other tools related to NSS (like<br>
    JSS), check out the NSS project wiki at<br>
    <a class="external" href="https://www.mozilla.org/projects/security/pki/nss/">http://www.mozilla.org/projects/security/pki/nss/</a>. The NSS site<br>
    relates directly to NSS code changes and releases.<br>
 <br>
    Mailing lists:<br>
    <a class="link-https" href="https://lists.mozilla.org/listinfo/dev-tech-crypto">https://lists.mozilla.org/listinfo/dev-tech-crypto</a><br>
 <br>
    IRC: Freenode at #dogtag-pki<br>
 <br>
 Authors<br>
 <br>
    The NSS tools were written and maintained by developers with<br>
    Netscape, Red Hat, Sun, Oracle, Mozilla, and Google.<br>
 <br>
    Authors: Elio Maldonado &lt;<a class="link-mailto" href="mailto:emaldona@redhat.com">emaldona@redhat.com</a>&gt;, Deon Lackey<br>
    &lt;<a class="link-mailto" href="mailto:dlackey@redhat.com">dlackey@redhat.com</a>&gt;.</p>

<p>LICENSE<br>
        Licensed under the Mozilla Public License, v. 2.0. If a copy of the MPL was not distributed with this file, You can<br>
        obtain one at https://mozilla.org/MPL/2.0/.</p>

<p>NOTES<br>
         1. Mozilla NSS bug 836477<br>
            https://bugzilla.mozilla.org/show_bug.cgi?id=836477</p>
