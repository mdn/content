API устройств вывода звука

Безопасный $контекст: эта функция доступна только в защищенных контекстах (HTTPS) в некоторых или во всех поддерживаемых браузерах.
$Эксеприментальность: Это экспериментальная технология. Внимательно проверьте таблицу совместимости браузеров, прежде чем использовать это в производстве.



API устройств вывода звука позволяет веб-приложениям подсказывать пользователям, какое устройство вывода звука следует использовать для воспроизведения.


Понятия и использование.
Операционные системы обычно позволяют пользователям указать, что звук должен воспроизводиться через динамики, гарнитуру Bluetooth или какое-либо другое устройство вывода звука. Этот API позволяет приложениям предоставлять те же функции внутри веб-страницы, что может улучшить взаимодействие с пользователем.

Для настройки конкретного устройства вывода звука требуется явное разрешение пользователя, поскольку пользователь может находиться в месте, где воспроизведение звука через некоторые устройства вывода нецелесообразно. Дополнительные сведения см. в разделе «Требования безопасности» ниже.

Аудиоустройства могут произвольно подключаться и отключаться. Приложения, которые хотят отреагировать на такого рода изменения, могут прослушивать событие --devicechange и использовать --enumerateDevices(), чтобы определить, присутствует ли в возвращаемых устройствах идентификатор --sinkId. Это может привести, например, к приостановке или возобновлению воспроизведения.



Интерфейсы.


Расширения для интерфейсов.

API устройств вывода звука расширяет следующие API, добавляя перечисленные функции:

--MediaDevices.selectAudioOutput()

Этот метод предлагает пользователю выбрать конкретное устройство вывода звука, например динамик или гарнитуру.

--HTMLMediaElement.setSinkId()

Этот метод устанавливает ID аудиоустройства для вывода, который будет использоваться, если это разрешено.

--HTMLMediaElement.sinkId

Это свойство возвращает уникальный ID аудиоустройства, используемого для вывода, или пустую строку, если используется устройство пользовательского агента по умолчанию.



Требования безопасности

Доступ к -- MediaDevices.selectAudioOutput() подвергается следующим ограничениям:

* Его можно использовать только в безопасном контексте.
* Доступ может быть ограничен -- speaker-selection Политики разрешений HTTP.
* Требуется временная $пользовательская активация. Чтобы эта функция работала, пользователь должен взаимодействовать со страницей или элементом пользовательского интерфейса.
* Пользователь должен явным образом предоставить разрешение на использование устройства вывода звука с помощью специального механизма пользовательского агента или ранее предоставил разрешение. Обратите внимание, что если доступ запрещен политикой разрешений, он не может быть предоставлен разрешением пользователя.

Разрешение пользователя на установку устройства вывода также предоставляется неявно, если пользователь уже предоставил разрешение на использование устройства ввода мультимедиа в той же группе, используя 
-- MediaDevices.getUserMedia().

Другие методы/свойства также требуют безопасного контекста и -- speaker-selection политикой разрешений.

Статус разрешения можно запросить с помощью метода Permissions API -- navigator.permissions.query(), передача дескриптора (описания) разрешений с -- speaker-selection разрешениями.


Спецификации

Audio Output Devices API
# dom-mediadevices-selectaudiooutput

Audio Output Devices API
# dom-htmlmediaelement-setsinkid

Audio Output Devices API
# dom-htmlmediaelement-sinkid


Совместимость с браузером

api.MediaDevices.selectAudioOutput
Report problems with this compatibility data on GitHub
